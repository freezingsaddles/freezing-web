{% extends "base.html" %}
{% block content %}
    <h2 class="mb-3">
        {% if meta %}
            {{ meta.name }}
        {% else %}
            {{ data.hashtag }} Photos
        {% endif %}
        {% if date %}
            <span class="h4 text-muted"> {{ date.strftime("%-d %b %Y") }}</span>
        {% endif %}
        <input id="date-picker"
               type="date"
               class="float-end title-date"
               value="{{ datestr or '' }}" />
    </h2>
    {% if meta %}
        <p>
            {{ meta.description | safe }}
        </p>
        {% if meta.url %}
            <p>
                See: <a href="{{ meta.url }}">{{ meta.url }}</a>
            </p>
        {% endif %}
        {% if meta.sponsor %}
            {% set sponsors = meta.sponsor.split(',') %}
            <p>
                Sponsored by
                {% for sp in sponsors %}
                    {# djlint:off #}
  <em
    ><a href="https://www.bikearlingtonforum.com/forums/users/{{ sp }}/"
      >{{ sp }}</a
    ></em
                    >{% if loop.last %}.{% else %}, {% endif %} {# djlint:on #}
                {% endfor %}
            </p>
        {% else %}
            <p class="text-muted">
                This ride has no sponsor and is completely pointless.
            </p>
        {% endif %}
    {% else %}
        <p>
            Photoboard for all rides hashtagged <code>{{ data.hashtag }}</code>
        </p>
        <p>
            To see your own, simply go edit your URL bar and replace
            <strong>{{ data.hashtag_notag }}</strong> with whatever you want. Only letters
            and numbers are allowed, and it is not case sensitive (so ilovekittens and
            ILoveKittens will generate <em>the same</em> results).
        </p>
    {% endif %}
    {% if photos %}
        <div class="photo-grid my-4 gap-lg-4 gallery-wrapper">
            {% for photo in photos %}
                <a
                    href="{{ photo.img_l }}"
                    data-toggle="lightbox"
                    data-gallery="multiimages"
                    class="photo-thumbnail"
                    data-title="{{ photo.name }}"
                    data-parent=".gallery-wrapper"
                    {# djlint:off #}
                    data-footer='<p class="caption">{{ photo.caption or '' | safe }}</p><p>Taken by <a href="/people/{{ photo.athlete_id }}" class="hover-underline">{{ photo.display_name }}</a></p>'
                    style="background-image: url('{{ photo.img_l }}'), url('/img/logo-blue.png');"
                  >
                    {# djlint:on #}
                </a>
            {% endfor %}
        </div>
        <nav class="d-flex justify-content-center">
            {# djlint:off H023#}
            <ul class="pagination">
                <li class="page-item {% if page < 2 %}disabled{% endif %}">
                    <a class="page-link"
                       href="{{ data.hashtag_notag }}?page={{ page-1 }}{% if datestr %}&date={{ datestr }}{% endif %}"><span aria-hidden="true">&larr;</span> Newer</a>
                </li>
                <li class="page-item disabled">
                    <a class="page-link">Page {{ page }} of {{ total_pages }}</a>
                </li>
                <li class="page-item {% if page >= total_pages %}disabled{% endif %}">
                    <a class="page-link"
                       href="{{ data.hashtag_notag }}?page={{ page+1 }}{% if datestr %}&date={{ datestr }}{% endif %}">Older <span aria-hidden="true">&rarr;</span></a>
                </li>
            </ul>
            {# djlint:on #}
        </nav>
    {% else %}
        <div class="my-4 text-muted alert alert-info">
            No photos found.
        </div>
    {% endif %}
{% endblock %}
{% block foot %}
    <script type="text/javascript">
  $(function () {
    $("#date-picker").on("change", (e) => {
      const date = e.target.value;
      document.location.search = date ? `?date=${date}` : "";
    });
  });
    </script>
{% endblock %}
